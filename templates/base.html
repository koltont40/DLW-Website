<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="DixieLand Wireless LLC delivers reliable rural internet and phone service for homes and businesses across Blount, St. Clair, and Jefferson counties in Alabama."
    />
    <meta
      name="keywords"
      content="Blount County internet, St. Clair County internet, Jefferson County Alabama WISP, rural broadband, Dixieland Wireless"
    />
    <meta name="geo.region" content="US-AL" />
    <meta name="geo.placename" content="Blount County, St. Clair County, Jefferson County" />
    <title>{% block title %}DixieLand Wireless LLC Portal{% endblock %}</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" />
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}" />
    {% if branding_assets.get('favicon') %}
    <link rel="icon" href="{{ url_for('branding_file', asset_type='favicon') }}" />
    {% endif %}
    {% if site_theme %}
    <style>
      :root {
        --bg: {{ site_theme.background_color }};
        --secondary: {{ site_theme.text_color }};
        --text: {{ site_theme.text_color }};
        --muted: {{ site_theme.muted_color }};
        --bg-image: {% if site_theme.background_image_filename %}url('{{ url_for('theme_background') }}'){% else %}none{% endif %};
      }
    </style>
    {% endif %}
  </head>
  <body>
    {% set header_container_class = header_container_class | default('container container-wide') %}
    {% set main_container_class = main_container_class | default('container container-wide') %}
    {% set footer_container_class = footer_container_class | default('container container-wide') %}
    <header class="site-header">
      <div class="{{ header_container_class }} header-content">
        <a class="brand" href="{{ url_for('index') }}">
          {% if branding_assets.get('logo') %}
          <img src="{{ url_for('branding_file', asset_type='logo') }}" alt="DixieLand Wireless LLC logo" />
          {% else %}
          DIXIELAND WIRELESS LLC
          {% endif %}
        </a>
        <button class="mobile-menu-button" type="button" aria-expanded="false" aria-controls="site-navigation">
          <span class="mobile-menu-icon" aria-hidden="true"></span>
          <span class="sr-only">Toggle navigation</span>
        </button>
        <nav id="site-navigation" class="nav-sections" data-state="closed">
          {% set current_path = request.path %}
          <div class="nav-primary">
            <a
              class="nav-pill{% if current_path == url_for('index') %} active{% endif %}"
              href="{{ url_for('index') }}"
              >Home</a
            >
            {% for item in navigation_items if item.label|lower not in ['sign up', 'client portal'] %}
            {% set is_active = current_path == item.url or current_path.startswith(item.url ~ '/') %}
            {% set label_lower = item.label|lower %}
            {% if label_lower == 'service plans' %}
            <div class="nav-menu">
              <a
                class="nav-pill nav-menu-toggle{% if is_active %} active{% endif %}"
                href="{{ item.url }}"
                aria-haspopup="true"
                aria-expanded="false"
              >
                {{ item.label }}
                <span class="nav-menu-icon" aria-hidden="true">▾</span>
              </a>
              <div class="nav-dropdown">
                <a class="nav-dropdown-link" href="{{ item.url }}">All Service Plans</a>
                {% for link in plan_category_links %}
                <a class="nav-dropdown-link" href="{{ link.url }}">{{ link.label }}</a>
                {% endfor %}
              </div>
            </div>
            {% else %}
            <a
              class="nav-pill{% if is_active %} active{% endif %}"
              href="{{ item.url }}"
              {% if item.open_in_new_tab %}target="_blank" rel="noopener"{% endif %}
              >{{ item.label }}</a
            >
            {% endif %}
            {% endfor %}
            <div class="nav-menu">
              <button class="nav-pill nav-menu-toggle" type="button" aria-haspopup="true" aria-expanded="false">
                Contact &amp; Support
                <span class="nav-menu-icon" aria-hidden="true">▾</span>
              </button>
              <div class="nav-dropdown">
                {% for link in support_links %}
                <a
                  class="nav-dropdown-link"
                  href="{{ link.url }}"
                  {% if link.external %}target="_blank" rel="noopener"{% endif %}
                  >{{ link.label }}</a
                >
                {% endfor %}
              </div>
            </div>
          </div>
          <div class="nav-cta-group">
            <a class="cta-button secondary" href="{{ url_for('portal_login') }}">My Account</a>
            <a class="cta-button primary" href="{{ url_for('signup') }}">Sign Up Now</a>
          </div>
        </nav>
      </div>
    </header>

    <main class="main-content">
      <div class="{{ main_container_class }}">
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            <div class="flash-wrapper">
              {% for category, message in messages %}
                <div class="flash flash-{{ category }}">{{ message }}</div>
              {% endfor %}
            </div>
          {% endif %}
        {% endwith %}
        {% set page_surface_class = page_surface_class | default('page-surface') %}
        {% if page_surface_class %}
        <div class="{{ page_surface_class }}">
        {% endif %}
          {% block content %}{% endblock %}
        {% if page_surface_class %}
        </div>
        {% endif %}
      </div>
    </main>

    <footer class="site-footer">
      <div class="{{ footer_container_class }} footer-content">
        <p>&copy; {{ current_year | default(2024) }} DIXIELAND WIRELESS LLC. All rights reserved.</p>
        <div class="footer-links">
          <a class="admin-login" href="{{ url_for('tech_login') }}">Tech Portal</a>
          <a class="admin-login" href="{{ url_for('login') }}">Admin</a>
        </div>
      </div>
    </footer>
    <script>
      (function () {
        const toggle = document.querySelector(".mobile-menu-button");
        const nav = document.getElementById("site-navigation");
        if (!toggle || !nav) {
          return;
        }

        const mediaQuery = window.matchMedia("(min-width: 769px)");

        const closeNav = () => {
          toggle.setAttribute("aria-expanded", "false");
          nav.dataset.state = "closed";
        };

        const ensureStateForViewport = () => {
          if (mediaQuery.matches) {
            nav.dataset.state = "open";
            toggle.setAttribute("aria-expanded", "false");
          } else if (toggle.getAttribute("aria-expanded") !== "true") {
            nav.dataset.state = "closed";
          }
        };

        toggle.addEventListener("click", () => {
          const expanded = toggle.getAttribute("aria-expanded") === "true";
          const next = !expanded;
          toggle.setAttribute("aria-expanded", String(next));
          nav.dataset.state = next ? "open" : "closed";
        });

        nav.querySelectorAll("a").forEach((link) => {
          link.addEventListener("click", () => {
            if (!mediaQuery.matches) {
              closeNav();
            }
          });
        });

        ensureStateForViewport();
        if (typeof mediaQuery.addEventListener === "function") {
          mediaQuery.addEventListener("change", ensureStateForViewport);
        } else if (typeof mediaQuery.addListener === "function") {
          mediaQuery.addListener(ensureStateForViewport);
        }
      })();

      (function () {
        const sidebars = document.querySelectorAll("[data-sidebar]");
        sidebars.forEach((sidebar) => {
          const toggle = sidebar.querySelector("[data-sidebar-toggle]");
          const content = sidebar.querySelector("[data-sidebar-content]");
          if (!toggle || !content) {
            return;
          }

          const expandLabel = toggle.dataset.expandLabel || "Show menu";
          const collapseLabel = toggle.dataset.collapseLabel || "Hide menu";

          const hasActiveLink = content.querySelector(".active");
          const initialExpanded = sidebar.dataset.expanded === "true" || (!!hasActiveLink && sidebar.dataset.expanded !== "false");

          const setExpanded = (expanded) => {
            sidebar.setAttribute("data-expanded", expanded ? "true" : "false");
            toggle.setAttribute("aria-expanded", expanded ? "true" : "false");
            toggle.textContent = expanded ? collapseLabel : expandLabel;
          };

          setExpanded(initialExpanded);

          toggle.addEventListener("click", () => {
            const isExpanded = sidebar.getAttribute("data-expanded") === "true";
            setExpanded(!isExpanded);
          });
        });
      })();

      (function () {
        const collapsibleSections = document.querySelectorAll("[data-collapsible]");
        collapsibleSections.forEach((section, index) => {
          const toggle = section.querySelector("[data-collapsible-toggle]");
          const content = section.querySelector("[data-collapsible-content]");
          if (!toggle || !content) {
            return;
          }

          if (!content.id) {
            content.id = `collapsible-${index}`;
          }
          if (!toggle.getAttribute("aria-controls")) {
            toggle.setAttribute("aria-controls", content.id);
          }

          const defaultOpen = section.dataset.defaultOpen === "true";

          const setState = (open) => {
            section.setAttribute("data-collapsible-open", open ? "true" : "false");
            toggle.setAttribute("aria-expanded", open ? "true" : "false");
            if (open) {
              content.removeAttribute("hidden");
            } else {
              content.setAttribute("hidden", "");
            }
          };

          setState(defaultOpen);

          toggle.addEventListener("click", () => {
            const isOpen = section.getAttribute("data-collapsible-open") === "true";
            setState(!isOpen);
          });
        });
      })();
    </script>
  </body>
</html>
